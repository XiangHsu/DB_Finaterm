<!DOCTYPE html>
<html>
<title>JFF</title>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" href="https://www.w3schools.com/w3css/4/w3.css">
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Karma">
<style>
body,h1,h2,h3,h4,h5,h6 {font-family: "Karma", sans-serif}
.w3-bar-block .w3-bar-item {padding:20px}
.styled-select.slate select {
   border: 1px solid #ccc;
   font-size: 16px;
   height: 34px;
   width: auto;
}
.styled-select.slate input {
   border: 1px solid #ccc;
   font-size: 16px;
   height: 34px;
   width: auto;
}
.styled-select.slate button {
   border: 1px solid #ccc;
   font-size: 16px;
   height: 34px;
   width: auto;
}
</style>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
<script>
    window.addEventListener("load",findmax);
    function findmax(){
        var xhttp;
        xhttp=new XMLHttpRequest();
        xhttp.onreadystatechange = function(){
          var data = JSON.parse(this.response) 
            var first=(data[0].name)
            var second=(data[1].kind)
            var third=(data[2].kind)
            var len = data.length
            var array=[];
            //var rand = Math.floor((Math.random()*len)+1);
            var times=0;
            /*while (times<4){//Random不重複
                array.push(Math.floor((Math.random()*len)+1));
                times+=1;
            }*/
            var x=0;
            while(x<4){
                var rand = Math.floor((Math.random()*len)+1);
                    if(array.indexOf(rand)==x){
                        x-=1;
                    }else{
                        array.push(rand);
                        x+=1;
                    }
            }
                //alert(array)

            document.getElementById("url1").href=data[array[0]].url
            document.getElementById("img1").src=data[array[0]].img
            document.getElementById("img1").alt=data[array[0]].kind
            document.getElementById("name1").innerHTML=data[array[0]].name
            document.getElementById("in1").innerHTML=data[array[0]].ingredients
            document.getElementById("url2").href=data[array[1]].url
            document.getElementById("img2").src=data[array[1]].img
            document.getElementById("img2").alt=data[array[1]].kind
            document.getElementById("name2").innerHTML=data[array[1]].name
            document.getElementById("in2").innerHTML=data[array[1]].ingredients
            document.getElementById("url3").href=data[array[2]].url
            document.getElementById("img3").src=data[array[2]].img
            document.getElementById("img3").alt=data[array[2]].kind
            document.getElementById("name3").innerHTML=data[array[2]].name
            document.getElementById("in3").innerHTML=data[array[2]].ingredients
            document.getElementById("url4").href=data[array[3]].url
            document.getElementById("img4").src=data[array[3]].img
            document.getElementById("img4").alt=data[array[3]].kind
            document.getElementById("name4").innerHTML=data[array[3]].name
            document.getElementById("in4").innerHTML=data[array[3]].ingredients
            setother();
        };
        xhttp.open("POST","findmax.php",true)
        xhttp.send();
        
    };
    function setother(){
         var xhttp;
        xhttp=new XMLHttpRequest();
        xhttp.onreadystatechange = function(){
          var data = JSON.parse(this.response) 
            var len = data.length
            var array2=[];
            var times=0;
            while (times<9){//Random不重複
                array2.push(Math.floor((Math.random()*len)+1));
                for(x=0;x<(array2.length-1);x++){
                    if(array2[x]==array2[x-1]){
                        array2.splice(x,1)
                        times-=1
                    }
                }
                times+=1;
            }
            document.getElementById("url5").href=data[array2[0]].url
            document.getElementById("img5").src=data[array2[0]].img
            document.getElementById("img5").alt=data[array2[0]].kind
            document.getElementById("name5").innerHTML=data[array2[0]].name
            document.getElementById("in5").innerHTML=data[array2[0]].ingredients
            document.getElementById("url6").href=data[array2[1]].url
            document.getElementById("img6").src=data[array2[1]].img
            document.getElementById("img6").alt=data[array2[1]].kind
            document.getElementById("name6").innerHTML=data[array2[1]].name
            document.getElementById("in6").innerHTML=data[array2[1]].ingredients
            document.getElementById("url7").href=data[array2[2]].url
            document.getElementById("img7").src=data[array2[2]].img
            document.getElementById("img7").alt=data[array2[2]].kind
            document.getElementById("name7").innerHTML=data[array2[2]].name
            document.getElementById("in7").innerHTML=data[array2[2]].ingredients
            document.getElementById("url8").href=data[array2[3]].url
            document.getElementById("img8").src=data[array2[3]].img
            document.getElementById("img8").alt=data[array2[3]].kind
            document.getElementById("name8").innerHTML=data[array2[3]].name
            document.getElementById("in8").innerHTML=data[array2[3]].ingredients
            document.getElementById("url9").href=data[array2[4]].url
            document.getElementById("img9").src=data[array2[4]].img
            document.getElementById("img9").alt=data[array2[4]].kind
            document.getElementById("name9").innerHTML=data[array2[4]].name
            document.getElementById("in9").innerHTML=data[array2[4]].ingredients
            document.getElementById("url10").href=data[array2[5]].url
            document.getElementById("img10").src=data[array2[5]].img
            document.getElementById("img10").alt=data[array2[5]].kind
            document.getElementById("name10").innerHTML=data[array2[5]].name
            document.getElementById("in10").innerHTML=data[array2[5]].ingredients
            document.getElementById("url11").href=data[array2[6]].url
            document.getElementById("img11").src=data[array2[6]].img
            document.getElementById("img11").alt=data[array2[6]].kind
            document.getElementById("name11").innerHTML=data[array2[6]].name
            document.getElementById("in11").innerHTML=data[array2[6]].ingredients
            document.getElementById("url12").href=data[array2[7]].url
            document.getElementById("img12").src=data[array2[7]].img
            document.getElementById("img12").alt=data[array2[7]].kind
            document.getElementById("name12").innerHTML=data[array2[7]].name
            document.getElementById("in12").innerHTML=data[array2[7]].ingredients
        };
        xhttp.open("POST","findother.php",true)
        xhttp.send();
    };
    $(document).ready(function(){
       $("#url1").click(function(){
           var data=$(this).children("img").attr('alt');
           update(data);
       });
        $("#url2").click(function(){
           var data=$(this).children("img").attr('alt');
            update(data);
       }); 
        $("#url3").click(function(){
           var data=$(this).children("img").attr('alt');
            update(data);
       }); 
        $("#url4").click(function(){
           var data=$(this).children("img").attr('alt');
            update(data);
       }); 
        $("#url5").click(function(){
           var data=$(this).children("img").attr('alt');
            update(data);
       }); 
        $("#url6").click(function(){
           var data=$(this).children("img").attr('alt');
            update(data);
       }); 
        $("#url7").click(function(){
           var data=$(this).children("img").attr('alt');
            update(data);
       }); 
        $("#url8").click(function(){
           var data=$(this).children("img").attr('alt');
            update(data);
       }); 
        $("#url9").click(function(){
           var data=$(this).children("img").attr('alt');
            update(data);
       }); 
        $("#url10").click(function(){
           var data=$(this).children("img").attr('alt');
            update(data);
       }); 
        $("#url11").click(function(){
           var data=$(this).children("img").attr('alt');
            update(data);
       }); 
        $("#url12").click(function(){
           var data=$(this).children("img").attr('alt');
            update(data);
       }); 
    });
    
    function update(data){
        $.post("updatetimes.php",{
           kind : data 
        });
    };
    function way(){
        var way_num= $('#way option:selected').val();
        var text = document.getElementById('text').value;
        if(way_num==1){
            in_search(text);
            alert("1")
        }else if(way_num==2){
             fun_search(text);
            alert("2")
        }
    };
    function in_search(text){
        $.post("in_search.php",{in : text},
              function(data){
            window.localStorage.setItem("result", data);
            window.location.href="searchresult.html";
        });
    };
    function fun_search(text){
        $.post("fun_search.php",{fun : text},
              function(data){
            window.localStorage.setItem("result", data);
            window.location.href="searchresult.html";
        });
    };
</script>
<body>

<!-- Sidebar (hidden by default) -->
<nav class="w3-sidebar w3-bar-block w3-card w3-top w3-xlarge w3-animate-left" style="display:none;z-index:2;width:30%;min-width:300px" id="mySidebar">
  <a href="javascript:void(0)" onclick="w3_close()"
  class="w3-bar-item w3-button">Close Menu</a>
  <a href="home.html" onclick="w3_close()" class="w3-bar-item w3-button" style="color: red">Home</a>
  <a href="pot.html" onclick="w3_close()" class="w3-bar-item w3-button">電鍋</a>
  <a href="oven.html" onclick="w3_close()" class="w3-bar-item w3-button">烤箱</a>
  <a href="http://120.108.111.85/phpMyAdmin" onclick="w3_close()" class="w3-bar-item w3-button">DataBase</a>
</nav>
<div id="main">
<!-- Top menu -->
<div class="w3-top">
  <div class="w3-white w3-xlarge" style="max-width:1200px;margin:auto">
    <div class="w3-button w3-padding-16 w3-left" onclick="w3_open()">☰</div>
    <div class="w3-right w3-padding-16">
       <center>
        <div class="styled-select slate">
        <select id="way" name="way">
          <option value="1">食材找食譜</option>
          <option value="2">料理方式/廚具找食譜</option>
        </select>
        <input style="font-family:fantasy" id="text"/>
        <button style="font-family:fantasy" onclick="way();">搜尋</button>
        </div>
      </center>
    </div>
    <div class="w3-center w3-padding-16">My Recipe</div>
  </div>
</div>
  
<!-- !PAGE CONTENT! -->
<div class="w3-main w3-content w3-padding" style="max-width:1200px;margin-top:100px" id="content">

  <!-- First Photo Grid-->
  <div class="w3-row-padding w3-padding-16 w3-center" id="food">
    <div class="w3-quarter">
     <a href="" id="url1">
      <img src=""  style="width:100%" id="img1" class="img">
      <h3 id="name1"></h3>
     </a>
      <span id="in1"></span>
    </div>
    <div class="w3-quarter">
     <a href="" id="url2">
      <img src=""  style="width:100%" id="img2">
      <h3 id="name2"></h3>
     </a>
      <p id="in2"></p>
    </div>
    <div class="w3-quarter">
     <a href="" id=url3>
      <img src="" style="width:100%" id="img3">
      <h3 id="name3"></h3>
     </a>
      <p id="in3"></p>
    </div>
    <div class="w3-quarter">
     <a href="" id="url4">
      <img src="" style="width:100%" id="img4">
      <h3 id="name4"></h3>
     </a>
      <p id="in4"></p>
    </div>
  </div>
  
  <!-- Second Photo Grid-->
  <div class="w3-row-padding w3-padding-16 w3-center">
    <div class="w3-quarter">
     <a href="" id="url5">
      <img src="" style="width:100%" id="img5">
      <h3 id="name5"></h3>
     </a>
      <p id="in5"></p>
    </div>
    <div class="w3-quarter">
     <a href="" id="url6">
      <img src="" style="width:100%" id="img6">
      <h3 id="name6"></h3>
     </a>
      <p id="in6"></p>
    </div>
    <div class="w3-quarter">
     <a href="" id="url7">
      <img src="" style="width:100%" id="img7">
      <h3 id="name7"></h3>
     </a>
      <p id="in7"></p>
    </div>
    <div class="w3-quarter">
     <a href="" id="url8">
      <img src="" style="width:100%" id="img8">
      <h3 id="name8"></h3>
     </a>
      <p id="in8"></p>
     </div>
    </div>
    <!--Third-->
    <div class="w3-row-padding w3-padding-16 w3-center">
    <div class="w3-quarter">
     <a href="" id="url9">
      <img src="" style="width:100%" id="img9">
      <h3 id="name9"></h3>
     </a>
      <p id="in9"></p>
    </div> 
    <div class="w3-quarter">
     <a href="" id="url10">
      <img src="" style="width:100%" id="img10">
      <h3 id="name10"></h3>
     </a>
      <p id="in10"></p>
    </div>
    <div class="w3-quarter">
     <a href="" id="url11">
      <img src="" style="width:100%" id="img11">
      <h3 id="name11"></h3>
     </a>
      <p id="in11"></p>
    </div>
    <div class="w3-quarter">
     <a href="" id="url12">
      <img src="" style="width:100%" id="img12">
      <h3 id="name12"></h3>
     </a>
      <p id="in12"></p>
    </div>
  </div>
  <!-- Footer -->
  <footer class="w3-row-padding w3-padding-32">
   <center>
    <div>
      <h3>FOOTER</h3>
    </div>
   </center>
  </footer>

<!-- End page content -->
</div>
</div>
<script>
// Script to open and close sidebar
function w3_open() {
    document.getElementById("main").style.marginLeft = "30%";
    document.getElementById("mySidebar").style.display = "block";
}
 
function w3_close() {
    document.getElementById("main").style.marginLeft = "0%";
    document.getElementById("mySidebar").style.display = "none";
}
</script>

</body>
</html>
